<div class="px-8 py-6">
  <!-- Header -->
  <div
    class="flex flex-col sm:flex-row items-start justify-between sm:space-x-4 w-full mb-6"
  >
    <h1 class="text-2xl xl:text-4xl font-semibold text-blue-600">
      Daftar Tamu
    </h1>
    <button
      [routerLink]="'create'"
      class="group relative mt-4 sm:mt-0 bg-gradient-to-r from-blue-600 to-indigo-600 text-white px-5 py-3 rounded-xl shadow-lg hover:from-blue-700 hover:to-indigo-700 transition-all duration-300 flex items-center space-x-3 font-semibold overflow-hidden"
    >
      <span
        class="absolute inset-0 w-full h-full bg-white/10 opacity-0 group-hover:opacity-100 transition duration-300"
      ></span>

      <svg
        viewBox="0 0 24 24"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
        class="size-6"
      >
        <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
        <g
          id="SVGRepo_tracerCarrier"
          stroke-linecap="round"
          stroke-linejoin="round"
        ></g>
        <g id="SVGRepo_iconCarrier">
          <path
            d="M15 16C14.7164 14.8589 13.481 14 12 14C10.519 14 9.28364 14.8589 9 16M11 3H13M12 10H12.01M8 5H6.2C5.0799 5 4.51984 5 4.09202 5.21799C3.71569 5.40973 3.40973 5.71569 3.21799 6.09202C3 6.51984 3 7.0799 3 8.2V16.8C3 17.9201 3 18.4802 3.21799 18.908C3.40973 19.2843 3.71569 19.5903 4.09202 19.782C4.51984 20 5.0799 20 6.2 20H17.8C18.9201 20 19.4802 20 19.908 19.782C20.2843 19.5903 20.5903 19.2843 20.782 18.908C21 18.4802 21 17.9201 21 16.8V8.2C21 7.07989 21 6.51984 20.782 6.09202C20.5903 5.71569 20.2843 5.40973 19.908 5.21799C19.4802 5 18.9201 5 17.8 5H16M13 10C13 10.5523 12.5523 11 12 11C11.4477 11 11 10.5523 11 10C11 9.44772 11.4477 9 12 9C12.5523 9 13 9.44772 13 10Z"
            stroke="#ffffff"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          ></path>
        </g>
      </svg>

      <span class="relative">Tambah Tamu</span>
    </button>
  </div>

  <!-- Search Box -->
  <div class="mb-4 flex flex-col sm:flex-row gap-4 mt-12">
    <input
      type="text"
      [(ngModel)]="searchTerm"
      (input)="onSearchChange($event)"
      placeholder="Cari Tamu berdasarkan nama, perusahaan..."
      class="w-full sm:w-1/2 border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
    />

    <!-- Filter Status -->
    <select
      [(ngModel)]="selectedStatus"
      (change)="onFilterChange()"
      class="w-full sm:w-1/4 border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
    >
      <option value="">Semua Status</option>
      <option value="expected">Dijadwalkan</option>
      <option value="checked_in">Check-in</option>
      <option value="checked_out">Check-out</option>
      <option value="cancelled">Dibatalkan</option>
    </select>

    <!-- Tujuan -->
    <select
      [(ngModel)]="selectedPurpose"
      (change)="onFilterChange()"
      class="w-full sm:w-1/4 border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
    >
      <option value="">Semua Tujuan</option>
      <option value="Meeting">Meeting</option>
      <option value="Interview">Interview</option>
      <option value="Business Visit">Business Visit</option>
      <option value="Maintenance">Maintenance</option>
      <option value="Delivery">Delivery</option>
      <option value="Psikotest">Psikotest</option>
      <option value="Vendor">Vendor</option>
      <option value="Lain-lain">Lain-lain</option>
    </select>

    <!-- Filter Rentang Tanggal -->
    <input
      type="date"
      [(ngModel)]="startDate"
      (change)="onFilterChange()"
      class="border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
    />
    <input
      type="date"
      [(ngModel)]="endDate"
      (change)="onFilterChange()"
      class="border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
    />

    <div>
      <button
        (click)="exportData()"
        [disabled]="loading"
        class="group relative mt-4 sm:mt-0 px-5 py-3 rounded-xl shadow-lg flex items-center space-x-3 font-semibold overflow-hidden text-white transition-all duration-300 bg-gradient-to-r from-green-600 to-green-600 hover:from-green-700 hover:to-green-700 disabled:opacity-60 disabled:cursor-not-allowed"
      >
        <ng-container *ngIf="!loading; else loadingTpl">
          <span>Export</span>
        </ng-container>

        <ng-template #loadingTpl>
          <div class="flex items-center space-x-2">
            <svg
              class="animate-spin h-5 w-5 text-white"
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
            >
              <circle
                class="opacity-25"
                cx="12"
                cy="12"
                r="10"
                stroke="currentColor"
                stroke-width="4"
              ></circle>
              <path
                class="opacity-75"
                fill="currentColor"
                d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"
              ></path>
            </svg>
            <span>Exporting...</span>
          </div>
        </ng-template>
      </button>
    </div>
  </div>

  <!-- Message -->
  <div
    *ngIf="successMessage"
    class="flex items-center p-4 mb-4 text-sm text-green-800 rounded-lg bg-green-100 border border-green-300 shadow-md"
    role="alert"
  >
    <svg
      class="flex-shrink-0 inline w-5 h-5 me-3 text-green-600"
      fill="currentColor"
      viewBox="0 0 20 20"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        fill-rule="evenodd"
        d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.707a1 1 0 00-1.414-1.414L9 10.586 7.707 
      9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 
      0l4-4z"
        clip-rule="evenodd"
      ></path>
    </svg>
    <span class="font-medium">{{ successMessage }}</span>
  </div>

  <!-- User Table -->
  <div class="overflow-hidden bg-white shadow-xl rounded-2xl mt-10">
    <div class="overflow-x-auto">
      <table class="min-w-full text-sm text-left">
        <thead
          class="bg-gradient-to-r from-blue-800 to-blue-600 text-white sticky top-0 z-10"
        >
          <tr>
            <th class="px-6 py-3 font-semibold uppercase tracking-wider">
              Nomor Identitas
            </th>
            <th class="px-6 py-3 font-semibold uppercase tracking-wider">
              Nama
            </th>
            <th class="px-6 py-3 font-semibold uppercase tracking-wider">
              Nomor Handphone
            </th>
            <th class="px-6 py-3 font-semibold uppercase tracking-wider">
              Tujuan
            </th>
            <th class="px-6 py-3 font-semibold uppercase tracking-wider">
              Perusahaan
            </th>
            <th class="px-6 py-3 font-semibold uppercase tracking-wider">
              Tanggal
            </th>
            <th class="px-6 py-3 font-semibold uppercase tracking-wider">
              Status
            </th>
            <th
              class="px-6 py-3 font-semibold text-center uppercase tracking-wider"
            >
              Aksi
            </th>
          </tr>
        </thead>

        <tbody class="divide-y divide-gray-200">
          <!-- Row dynamic -->
          <tr
            *ngFor="let guest of guests; let i = index"
            class="hover:bg-gray-50 transition duration-200 odd:bg-white even:bg-gray-50"
          >
            <td class="px-6 py-4 whitespace-nowrap text-gray-800">
              {{ guest.id_card ?? "-" }}
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-gray-800">
              {{ guest.fullname ?? "-" }}
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-gray-800">
              {{ guest.phone ?? "-" }}
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-gray-800">
              {{ guest.visit_purpose ?? "-" }}
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-gray-800">
              {{ guest.company ?? "-" }}
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-gray-800">
              {{ formatDateToIndo(guest.visit_date) }}
            </td>
            <td
              class="px-6 py-4 whitespace-nowrap"
              [ngClass]="getStatusClass(guest.status)"
            >
              {{ translateStatus(guest.status) }}
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
              <div class="flex justify-center gap-2">
                <!-- Edit -->
                <button
                  [routerLink]="['/gas/guest/edit', guest.id]"
                  class="flex items-center gap-1 px-3 py-1 rounded-lg bg-indigo-50 text-indigo-600 hover:bg-indigo-600 hover:text-white transition"
                  title="Edit"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="w-4 h-4"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M15.232 5.232l3.536 3.536M9 11l-4 4v4h4l10-10-4-4-10 10z"
                    />
                  </svg>
                  <span>Edit</span>
                </button>

                <!-- Delete -->
                <button
                  (click)="openDeleteModal(guest)"
                  class="flex items-center gap-1 px-3 py-1 rounded-lg bg-red-50 text-red-600 hover:bg-red-600 hover:text-white transition"
                  title="Delete"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="w-4 h-4"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M6 18L18 6M6 6l12 12"
                    />
                  </svg>
                  <span>Delete</span>
                </button>
              </div>
            </td>
          </tr>

          <!-- Empty State -->
          <tr *ngIf="guests.length === 0">
            <td colspan="8" class="px-6 py-10 text-center">
              <div
                class="flex flex-col items-center justify-center space-y-3 text-gray-500"
              >
                <!-- Icon -->
                <div class="bg-gray-100 p-4 rounded-full shadow-sm">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="currentColor"
                    class="w-10 h-10 text-gray-400"
                  >
                    <path
                      fill-rule="evenodd"
                      d="M12 2.25c-5.385 0-9.75 4.365-9.75 
            9.75s4.365 9.75 9.75 9.75 9.75-4.365 
            9.75-9.75S17.385 2.25 12 2.25Zm-2.625 
            6c-.54 0-.828.419-.936.634a1.96 1.96 
            0 0 0-.189.866c0 .298.059.605.189.866.108.215.395.634.936.634.54 
            0 .828-.419.936-.634.13-.26.189-.568.189-.866 
            0-.298-.059-.605-.189-.866-.108-.215-.395-.634-.936-.634Zm4.314.634c.108-.215.395-.634.936-.634.54 
            0 .828.419.936.634.13.26.189.568.189.866 
            0 .298-.059.605-.189.866-.108.215-.395.634-.936.634-.54 
            0-.828-.419-.936-.634a1.96 1.96 0 0 1-.189-.866c0-.298.059-.605.189-.866Zm-4.34 
            7.964a.75.75 0 0 1-1.061-1.06 
            5.236 5.236 0 0 1 3.73-1.538 
            5.236 5.236 0 0 1 3.695 
            1.538.75.75 0 1 1-1.061 
            1.06 3.736 3.736 0 0 0-2.639-1.098 
            3.736 3.736 0 0 0-2.664 1.098Z"
                      clip-rule="evenodd"
                    />
                  </svg>
                </div>

                <!-- Text -->
                <p class="text-lg font-semibold">Oops, tidak ada data tamu!</p>
                <p class="text-sm text-gray-400">
                  Coba tambahkan tamu baru untuk memulai
                </p>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Pagination -->
    <div class="flex items-center justify-between p-4 border-t bg-gray-50">
      <button
        (click)="goToPage(page - 1)"
        [disabled]="page === 1"
        class="px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed"
      >
        ← Prev
      </button>

      <span class="text-sm text-gray-600">
        Halaman <span class="font-semibold">{{ page }}</span> dari
        <span class="font-semibold">{{ totalPages }}</span>
      </span>

      <button
        (click)="goToPage(page + 1)"
        [disabled]="page === totalPages"
        class="px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed"
      >
        Next →
      </button>
    </div>
  </div>
</div>
<!-- Modal Delete -->
<div
  *ngIf="showDeleteModal"
  class="fixed inset-0 flex items-center justify-center bg-black/40 backdrop-blur-sm z-50"
>
  <!-- Animasi modal -->
  <div
    class="bg-white rounded-2xl shadow-xl w-full max-w-md p-6 transform transition-all duration-300 scale-95 animate-fadeIn"
  >
    <!-- Header -->
    <div class="flex items-center gap-3 mb-4">
      <div
        class="flex items-center justify-center w-10 h-10 rounded-full bg-red-100 text-red-600"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="1.5"
          stroke="currentColor"
          class="size-6"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M15 12H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"
          />
        </svg>
      </div>
      <h2 class="text-xl font-semibold text-gray-800">Konfirmasi Hapus</h2>
    </div>

    <!-- Body -->
    <p class="text-gray-600 mb-6 leading-relaxed">
      Apakah Anda yakin ingin menghapus
      <span class="font-bold text-red-600">{{ selectedGuest?.fullname }}</span
      >?
    </p>

    <!-- Footer -->
    <div class="flex justify-end gap-3">
      <button
        (click)="cancelDelete()"
        class="px-4 py-2 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 transition"
      >
        Batal
      </button>
      <button
        (click)="confirmDelete()"
        class="px-4 py-2 rounded-lg bg-red-600 text-white hover:bg-red-700 shadow-md transition"
      >
        <i class="fas fa-trash-alt mr-2"></i> Hapus
      </button>
    </div>
  </div>
</div>
